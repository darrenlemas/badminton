<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badminton England - All Stars</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #2ecc71 0%, #16a085 100%);
            font-family: 'Arial', sans-serif;
            color: white;
        }

        .game-container {
            text-align: center;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .logo-container {
            margin-bottom: 20px;
        }

        .logo {
            max-width: 200px;
            height: auto;
        }

        .scoreboard {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            max-width: 800px;
            width: 100%;
        }

        .scoreboard h3 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .sets-display {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .current-score {
            display: flex;
            justify-content: space-around;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-detail {
            text-align: center;
        }

        .sets-won {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin-top: 5px;
        }

        .set-indicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .set-indicator.won {
            background: #ffd700;
            color: #333;
        }

        canvas {
            border: 4px solid white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: #2d8659;
        }

        .controls {
            margin-top: 20px;
            font-size: 1.2rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 30px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .controls p {
            margin: 5px 0;
        }

        .restart-btn {
            margin-top: 15px;
            padding: 10px 30px;
            font-size: 1.1rem;
            background: white;
            color: #2ecc71;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.2s;
            font-weight: bold;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 40px;
            border-radius: 20px;
            display: none;
            text-align: center;
        }

        .game-over h2 {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            display: none;
        }

        .set-winner-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px 60px;
            border-radius: 20px;
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            z-index: 10000;
            display: none;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="logo-container">
            <img src="https://www.badmintonengland.co.uk/wp-content/uploads/2021/03/Badminton-England-Logo.png" alt="Badminton England" class="logo" onerror="this.style.display='none'">
        </div>

        <h1>Badminton England - All Stars</h1>

        <div class="scoreboard">
            <h3>Best of 3 Sets - First to 21 Points</h3>

            <div class="current-score">
                <div class="score-detail">
                    <div>Player 1</div>
                    <div id="player1Score">0</div>
                    <div class="sets-won">
                        <div class="set-indicator" id="p1-set1">1</div>
                        <div class="set-indicator" id="p1-set2">2</div>
                        <div class="set-indicator" id="p1-set3">3</div>
                    </div>
                </div>

                <div class="score-detail">
                    <div>Player 2 (AI)</div>
                    <div id="player2Score">0</div>
                    <div class="sets-won">
                        <div class="set-indicator" id="p2-set1">1</div>
                        <div class="set-indicator" id="p2-set2">2</div>
                        <div class="set-indicator" id="p2-set3">3</div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; font-size: 1rem; opacity: 0.9;">
                Set <span id="currentSet">1</span> of 3
            </div>
        </div>

        <canvas id="gameCanvas" width="800" height="400"></canvas>

        <div class="controls">
            <p><strong>Controls:</strong></p>
            <p>W = Move Up | S = Move Down | A = Move Left | D = Move Right</p>
            <p>First to 21 points wins the set. First to 2 sets wins the match!</p>
            <button class="restart-btn" onclick="restartGame()">Restart Game</button>
        </div>
    </div>

    <div class="game-over" id="gameOver">
        <h2 id="winnerText"></h2>
        <button class="restart-btn" onclick="restartGame()">Play Again</button>
    </div>

    <canvas id="confettiCanvas" class="confetti-canvas"></canvas>
    <div id="setWinnerMessage" class="set-winner-message"></div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game objects
        const game = {
            width: canvas.width,
            height: canvas.height,
            running: true,
            winner: null
        };

        // Racket properties
        const paddleWidth = 15;
        const paddleHeight = 90;

        const player1 = {
            x: 20,
            y: canvas.height / 2 - paddleHeight / 2,
            width: paddleWidth,
            height: paddleHeight,
            speed: 6,
            score: 0,
            setsWon: 0,
            dy: 0
        };

        const player2 = {
            x: canvas.width - 30,
            y: canvas.height / 2 - paddleHeight / 2,
            width: paddleWidth,
            height: paddleHeight,
            speed: 4,
            score: 0,
            setsWon: 0
        };

        let currentSet = 1;

        // Ball properties
        const ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 8,
            speed: 5,
            dx: 5,
            dy: 3
        };

        // Keyboard state
        const keys = {};

        // Event listeners
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        // Draw functions
        function drawRect(x, y, width, height, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, width, height);
        }

        function drawCircle(x, y, radius, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawShuttlecock(x, y, direction) {
            // direction: 1 for right, -1 for left
            const flip = direction > 0 ? 1 : -1;

            // Draw shuttlecock cork (rounded tip) - always at the front
            ctx.fillStyle = '#ffd700';
            ctx.beginPath();
            ctx.arc(x + (flip * 8), y, 6, 0, Math.PI * 2);
            ctx.fill();

            // Draw feather cone (back of shuttlecock)
            ctx.strokeStyle = 'white';
            ctx.fillStyle = 'white';
            ctx.lineWidth = 2;

            // Main cone shape - feathers point backward
            ctx.beginPath();
            ctx.moveTo(x - (flip * 8), y - 8);
            ctx.lineTo(x + (flip * 8), y);
            ctx.lineTo(x - (flip * 8), y + 8);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Add feather lines
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            for (let i = -6; i <= 6; i += 3) {
                ctx.beginPath();
                ctx.moveTo(x - (flip * 8), y + i);
                ctx.lineTo(x + (flip * 3), y + i * 0.3);
                ctx.stroke();
            }
        }

        function drawNet() {
            // Net post at top
            drawRect(canvas.width / 2 - 3, 0, 6, canvas.height, 'rgba(50, 50, 50, 0.6)');

            // Net mesh pattern
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.lineWidth = 1;

            // Vertical lines
            for (let i = 0; i < canvas.height; i += 10) {
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2 - 15, i);
                ctx.lineTo(canvas.width / 2 + 15, i);
                ctx.stroke();
            }

            // Horizontal accent
            for (let i = -15; i <= 15; i += 5) {
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2 + i, 0);
                ctx.lineTo(canvas.width / 2 + i, canvas.height);
                ctx.stroke();
            }
        }

        function draw() {
            // Clear canvas
            drawRect(0, 0, canvas.width, canvas.height, '#2d8659');

            // Draw net
            drawNet();

            // Draw rackets (paddles)
            drawRect(player1.x, player1.y, player1.width, player1.height, '#ffcc00');
            drawRect(player2.x, player2.y, player2.width, player2.height, '#ff6b6b');

            // Draw shuttlecock (pointing in direction of travel)
            drawShuttlecock(ball.x, ball.y, ball.dx);
        }

        // Update game state
        function update() {
            if (!game.running) return;

            // Player 1 controls - vertical movement
            if (keys['w'] && player1.y > 0) {
                player1.y -= player1.speed;
            }
            if (keys['s'] && player1.y < canvas.height - player1.height) {
                player1.y += player1.speed;
            }

            // Player 1 controls - horizontal movement
            if (keys['a'] && player1.x > 0) {
                player1.x -= player1.speed;
            }
            if (keys['d'] && player1.x < canvas.width / 2 - 50) {
                player1.x += player1.speed;
            }

            // AI for Player 2 (simple following) - vertical movement
            const ballCenter = ball.y;
            const player2Center = player2.y + player2.height / 2;

            if (ballCenter < player2Center - 35) {
                player2.y -= player2.speed;
            } else if (ballCenter > player2Center + 35) {
                player2.y += player2.speed;
            }

            // AI for Player 2 - horizontal movement (move closer when ball is near)
            if (ball.x > canvas.width / 2 && ball.dx > 0) {
                // Ball coming towards player2, move toward net
                if (player2.x > canvas.width / 2 + 50) {
                    player2.x -= player2.speed * 0.7;
                }
            } else {
                // Ball going away, return to baseline
                if (player2.x < canvas.width - 30) {
                    player2.x += player2.speed * 0.5;
                }
            }

            // Keep player2 in bounds
            if (player2.y < 0) player2.y = 0;
            if (player2.y > canvas.height - player2.height) {
                player2.y = canvas.height - player2.height;
            }
            if (player2.x < canvas.width / 2 + 50) player2.x = canvas.width / 2 + 50;
            if (player2.x > canvas.width - 30) player2.x = canvas.width - 30;

            // Update ball position
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Ball collision with top and bottom
            if (ball.y - ball.radius < 0 || ball.y + ball.radius > canvas.height) {
                ball.dy *= -1;
            }

            // Ball collision with paddles
            if (ball.x - ball.radius < player1.x + player1.width &&
                ball.y > player1.y &&
                ball.y < player1.y + player1.height) {
                ball.dx = Math.abs(ball.dx);
                ball.dx *= 1.05; // Slight speed increase

                // Add some variation to ball angle
                const hitPos = (ball.y - player1.y) / player1.height;
                ball.dy = (hitPos - 0.5) * 8;
            }

            if (ball.x + ball.radius > player2.x &&
                ball.y > player2.y &&
                ball.y < player2.y + player2.height) {
                ball.dx = -Math.abs(ball.dx);
                ball.dx *= 1.05; // Slight speed increase

                // Add some variation to ball angle
                const hitPos = (ball.y - player2.y) / player2.height;
                ball.dy = (hitPos - 0.5) * 8;
            }

            // Score points
            if (ball.x - ball.radius < 0) {
                player2.score++;
                updateScore();
                resetBall();
                checkSetWinner();
            }

            if (ball.x + ball.radius > canvas.width) {
                player1.score++;
                updateScore();
                resetBall();
                checkSetWinner();
            }
        }

        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speed = 5;
            ball.dx = (Math.random() > 0.5 ? 1 : -1) * 5;
            ball.dy = (Math.random() - 0.5) * 6;
        }

        function updateScore() {
            document.getElementById('player1Score').textContent = player1.score;
            document.getElementById('player2Score').textContent = player2.score;
            document.getElementById('currentSet').textContent = currentSet;

            // Update set indicators
            for (let i = 1; i <= 3; i++) {
                const p1Indicator = document.getElementById(`p1-set${i}`);
                const p2Indicator = document.getElementById(`p2-set${i}`);

                if (i <= player1.setsWon) {
                    p1Indicator.classList.add('won');
                } else {
                    p1Indicator.classList.remove('won');
                }

                if (i <= player2.setsWon) {
                    p2Indicator.classList.add('won');
                } else {
                    p2Indicator.classList.remove('won');
                }
            }
        }

        function checkSetWinner() {
            if (player1.score >= 21) {
                player1.setsWon++;
                game.running = false; // Pause game during celebration
                updateScore();
                showConfetti('Player 1');

                setTimeout(() => {
                    currentSet++;
                    player1.score = 0;
                    player2.score = 0;
                    updateScore();
                    checkMatchWinner();
                    if (game.winner === null) {
                        game.running = true; // Resume if match not over
                    }
                }, 3000);
            } else if (player2.score >= 21) {
                player2.setsWon++;
                game.running = false; // Pause game during celebration
                updateScore();
                showConfetti('Player 2 (AI)');

                setTimeout(() => {
                    currentSet++;
                    player1.score = 0;
                    player2.score = 0;
                    updateScore();
                    checkMatchWinner();
                    if (game.winner === null) {
                        game.running = true; // Resume if match not over
                    }
                }, 3000);
            }
        }

        function checkMatchWinner() {
            if (player1.setsWon >= 2) {
                game.running = false;
                game.winner = 'player1';
                showGameOver('You Win the Match!');
            } else if (player2.setsWon >= 2) {
                game.running = false;
                game.winner = 'player2';
                showGameOver('AI Wins the Match!');
            }
        }

        function showGameOver(message) {
            document.getElementById('winnerText').textContent = message;
            document.getElementById('gameOver').style.display = 'block';
        }

        function restartGame() {
            player1.score = 0;
            player2.score = 0;
            player1.setsWon = 0;
            player2.setsWon = 0;
            currentSet = 1;
            game.winner = null;
            player1.x = 20;
            player1.y = canvas.height / 2 - paddleHeight / 2;
            player2.x = canvas.width - 30;
            player2.y = canvas.height / 2 - paddleHeight / 2;
            updateScore();
            resetBall();
            game.running = true;
            document.getElementById('gameOver').style.display = 'none';
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Confetti System
        const confettiCanvas = document.getElementById('confettiCanvas');
        const confettiCtx = confettiCanvas.getContext('2d');
        let confettiParticles = [];
        let confettiAnimationId = null;

        function initConfetti() {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
        }

        class ConfettiParticle {
            constructor() {
                this.x = Math.random() * confettiCanvas.width;
                this.y = -10;
                this.size = Math.random() * 10 + 5;
                this.speedY = Math.random() * 3 + 2;
                this.speedX = Math.random() * 2 - 1;
                this.color = this.randomColor();
                this.rotation = Math.random() * 360;
                this.rotationSpeed = Math.random() * 10 - 5;
            }

            randomColor() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#ff1493', '#00ff7f', '#ffd700'];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            update() {
                this.y += this.speedY;
                this.x += this.speedX;
                this.rotation += this.rotationSpeed;
            }

            draw() {
                confettiCtx.save();
                confettiCtx.translate(this.x, this.y);
                confettiCtx.rotate(this.rotation * Math.PI / 180);
                confettiCtx.fillStyle = this.color;
                confettiCtx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
                confettiCtx.restore();
            }
        }

        function createConfetti() {
            for (let i = 0; i < 150; i++) {
                confettiParticles.push(new ConfettiParticle());
            }
        }

        function animateConfetti() {
            confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);

            for (let i = confettiParticles.length - 1; i >= 0; i--) {
                confettiParticles[i].update();
                confettiParticles[i].draw();

                if (confettiParticles[i].y > confettiCanvas.height) {
                    confettiParticles.splice(i, 1);
                }
            }

            if (confettiParticles.length > 0) {
                confettiAnimationId = requestAnimationFrame(animateConfetti);
            } else {
                confettiCanvas.style.display = 'none';
            }
        }

        function showConfetti(winner) {
            initConfetti();
            confettiCanvas.style.display = 'block';
            confettiParticles = [];
            createConfetti();
            animateConfetti();

            // Show set winner message
            const message = document.getElementById('setWinnerMessage');
            message.textContent = winner + ' wins the set!';
            message.style.display = 'block';

            setTimeout(() => {
                message.style.display = 'none';
            }, 3000);
        }

        // Initialize confetti canvas on load
        initConfetti();
        window.addEventListener('resize', initConfetti);

        // Start the game
        gameLoop();
    </script>
</body>
</html>
